/*! accordion 0.1.0 — © MEOM */
class t{constructor(t,e={}){this.evtCallbacks={};t&&"string"==typeof t?(this.$accordions=document.querySelectorAll(t),this.$accordions?(this.settings={allowMultipleOpen:!0,openFirstByDefault:!1,onCreate:null,onOpen:null,onClose:null,onToggle:null,...e},this.$accordions.forEach(((t,e)=>{this.setupAccordion(t,e)})),this.settings.onCreate&&"function"==typeof this.settings.onCreate&&this.settings.onCreate()):console.error("MEOM Accordion: Target not found. A valid target (accordion area) must be used.")):console.error("MEOM Accordion: No target supplied. A valid target (accordion area) must be used.")}destroy(){this.removeAllEventListeners(),this.$accordions.forEach((t=>{const[e,s]=this.getAccordionLinksAndContent(t);e.forEach((t=>{t.removeAttribute("id"),t.removeAttribute("aria-expanded"),t.removeAttribute("aria-controls")})),s.forEach((t=>{t.removeAttribute("id"),t.removeAttribute("aria-hidden"),t.removeAttribute("aria-labelledby")}))}))}getAccordionLinksAndContent(t){return[t.querySelectorAll(".accordion-header"),t.querySelectorAll(".accordion-content")]}addEventListener(t,e,s){void 0===this.evtCallbacks[e]&&(this.evtCallbacks[e]=[]),this.evtCallbacks[e].push({element:t,callback:s}),t.addEventListener(e,s)}removeAllEventListeners(){Object.keys(this.evtCallbacks).forEach((t=>{this.evtCallbacks[t].forEach((({element:e,callback:s})=>{e.removeEventListener(t,s)}))}))}setupAccordion(t,e){const[s,i]=this.getAccordionLinksAndContent(t);this.addEventListener(t,"keydown",(t=>{const e=t.target,i=t.which;e.classList.contains("accordion-header")&&this.accessKeyBindings(s,e,i,t)})),s.forEach(((s,i)=>{s.setAttribute("id",`accordion-${e}-${i}`),s.setAttribute("aria-expanded","false"),s.setAttribute("aria-controls",`panel-${e}-${i}`),this.addEventListener(s,"click",(e=>{e.preventDefault(),this.toggleAccordionItem(e,t)}))})),i.forEach(((t,s)=>{t.setAttribute("id",`panel-${e}-${s}`),t.setAttribute("aria-hidden","true"),t.setAttribute("aria-labelledby",`accordion-${e}-${s}`)})),console.log(this.settings.openFirstByDefault),this.settings.openFirstByDefault&&s[0].click()}openAccordionItem(t){const{link:e,content:s}=t;e.setAttribute("aria-expanded","true"),s.setAttribute("aria-hidden","false"),this.settings.onOpen&&"function"==typeof this.settings.onOpen&&this.settings.onOpen(t)}closeAccordionItem(t){const{link:e,content:s}=t;e.setAttribute("aria-expanded","false"),s.setAttribute("aria-hidden","true"),this.settings.onClose&&"function"==typeof this.settings.onClose&&this.settings.onClose(t)}toggleAccordionItem(t,e){const s=t.target,i=s.closest(".accordion__item"),n=s.parentElement.nextElementSibling,o=e.querySelector('.accordion-header[aria-expanded="true"]');!this.settings.allowMultipleOpen&&o&&o!==s&&o.click();const r=n.querySelector(".accordion-label"),a={item:i,link:s,content:n,heading:r};i.classList.toggle("is-active"),s.classList.toggle("is-active"),n.classList.toggle("is-active"),r&&(r.setAttribute("tabindex",-1),r.focus()),n.classList.contains("is-active")?this.openAccordionItem(a):this.closeAccordionItem(a),this.settings.onToggle&&"function"==typeof this.settings.onToggle&&this.settings.onToggle(a)}accessKeyBindings(t,e,s,i){let n;switch(t.forEach(((t,s)=>{e===t&&(n=s)})),s){case 35:n=t.length-1,i.preventDefault();break;case 36:n=0,i.preventDefault();break;case 38:n--,n<0&&(n=t.length-1),i.preventDefault();break;case 40:n++,n>t.length-1&&(n=0),i.preventDefault()}t[n].focus()}}export{t as Accordion};
