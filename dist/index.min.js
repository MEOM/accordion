/*! accordion 0.1 — © MEOM */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Accordion={})}(this,(function(e){"use strict";e.Accordion=class{constructor(e,t={}){this.evtCallbacks={};e&&"string"==typeof e?(this.$accordions=document.querySelectorAll(e),this.$accordions?(this.settings={allowMultipleOpen:!0,openFirstByDefault:!1,onCreate:null,onOpen:null,onClose:null,onToggle:null,...t},this.$accordions.forEach(((e,t)=>{this.setupAccordion(e,t)})),this.settings.onCreate&&"function"==typeof this.settings.onCreate&&this.settings.onCreate()):console.error("MEOM Accordion: Target not found. A valid target (accordion area) must be used.")):console.error("MEOM Accordion: No target supplied. A valid target (accordion area) must be used.")}destroy(){this.removeAllEventListeners(),this.$accordions.forEach((e=>{const[t,n]=this.getAccordionLinksAndContent(e);t.forEach((e=>{e.removeAttribute("id"),e.removeAttribute("aria-expanded"),e.removeAttribute("aria-controls")})),n.forEach((e=>{e.removeAttribute("id"),e.removeAttribute("aria-hidden"),e.removeAttribute("aria-labelledby")}))}))}getAccordionLinksAndContent(e){return[e.querySelectorAll(".accordion-header"),e.querySelectorAll(".accordion-content")]}addEventListener(e,t,n){void 0===this.evtCallbacks[t]&&(this.evtCallbacks[t]=[]),this.evtCallbacks[t].push({element:e,callback:n}),e.addEventListener(t,n)}removeAllEventListeners(){Object.keys(this.evtCallbacks).forEach((e=>{this.evtCallbacks[e].forEach((({element:t,callback:n})=>{t.removeEventListener(e,n)}))}))}setupAccordion(e,t){const[n,i]=this.getAccordionLinksAndContent(e);this.addEventListener(e,"keydown",(e=>{const t=e.target,i=e.which;t.classList.contains("accordion-header")&&this.accessKeyBindings(n,t,i,e)})),n.forEach(((n,i)=>{n.setAttribute("id",`accordion-${t}-${i}`),n.setAttribute("aria-expanded","false"),n.setAttribute("aria-controls",`panel-${t}-${i}`),this.addEventListener(n,"click",(t=>{t.preventDefault(),this.toggleAccordionItem(t,e)}))})),i.forEach(((e,n)=>{e.setAttribute("id",`panel-${t}-${n}`),e.setAttribute("aria-hidden","true"),e.setAttribute("aria-labelledby",`accordion-${t}-${n}`)})),console.log(this.settings.openFirstByDefault),this.settings.openFirstByDefault&&n[0].click()}openAccordionItem(e){const{link:t,content:n}=e;t.setAttribute("aria-expanded","true"),n.setAttribute("aria-hidden","false"),this.settings.onOpen&&"function"==typeof this.settings.onOpen&&this.settings.onOpen(e)}closeAccordionItem(e){const{link:t,content:n}=e;t.setAttribute("aria-expanded","false"),n.setAttribute("aria-hidden","true"),this.settings.onClose&&"function"==typeof this.settings.onClose&&this.settings.onClose(e)}toggleAccordionItem(e,t){const n=e.target,i=n.closest(".accordion__item"),o=n.parentElement.nextElementSibling,s=t.querySelector('.accordion-header[aria-expanded="true"]');!this.settings.allowMultipleOpen&&s&&s!==n&&s.click();const c=o.querySelector(".accordion-label"),r={item:i,link:n,content:o,heading:c};i.classList.toggle("is-active"),n.classList.toggle("is-active"),o.classList.toggle("is-active"),c&&(c.setAttribute("tabindex",-1),c.focus()),o.classList.contains("is-active")?this.openAccordionItem(r):this.closeAccordionItem(r),this.settings.onToggle&&"function"==typeof this.settings.onToggle&&this.settings.onToggle(r)}accessKeyBindings(e,t,n,i){let o;switch(e.forEach(((e,n)=>{t===e&&(o=n)})),n){case 35:o=e.length-1,i.preventDefault();break;case 36:o=0,i.preventDefault();break;case 38:o--,o<0&&(o=e.length-1),i.preventDefault();break;case 40:o++,o>e.length-1&&(o=0),i.preventDefault()}e[o].focus()}},Object.defineProperty(e,"__esModule",{value:!0})}));
